(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{345:function(t,s,a){"use strict";a.r(s);var e=a(8),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"前置条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[t._v("#")]),t._v(" 前置条件")]),t._v(" "),s("h3",{attrs:{id:"数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库"}},[t._v("#")]),t._v(" 数据库")]),t._v(" "),s("h4",{attrs:{id:"mysql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[t._v("#")]),t._v(" MySQL")]),t._v(" "),s("p",[s("code",[t._v("MySQL 5.7")]),t._v(" 以上")]),t._v(" "),s("p",[t._v("已亲测"),s("code",[t._v("8")]),t._v("版本没有问题")]),t._v(" "),s("h4",{attrs:{id:"postgresql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#postgresql"}},[t._v("#")]),t._v(" PostgreSQL")]),t._v(" "),s("p",[t._v("已亲测"),s("code",[t._v("15")]),t._v("版本没有问题")]),t._v(" "),s("h4",{attrs:{id:"oracle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#oracle"}},[t._v("#")]),t._v(" Oracle")]),t._v(" "),s("p",[t._v("已亲测"),s("code",[t._v("11g")]),t._v("版本没有问题")]),t._v(" "),s("h4",{attrs:{id:"其他数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他数据库"}},[t._v("#")]),t._v(" 其他数据库")]),t._v(" "),s("p",[t._v("代码中仅用到了基础的SQL语法："),s("code",[t._v("LEFT JOIN")]),t._v("、"),s("code",[t._v("INNER JOIN")]),t._v("、"),s("code",[t._v("ORDER BY")]),t._v("、"),s("code",[t._v("BETWEEN AND")]),t._v("、"),s("code",[t._v("DISTINCT")])]),t._v(" "),s("p",[t._v("这几个函数在"),s("code",[t._v("MySQL")]),t._v("、"),s("code",[t._v("PostgreSQL")]),t._v("、"),s("code",[t._v("Oracle")]),t._v("上用法大致一致")]),t._v(" "),s("p",[t._v("其他数据库未经测试")]),t._v(" "),s("p",[t._v("如果其他数据库有问题，欢迎提交"),s("code",[t._v("PR")])]),t._v(" "),s("h3",{attrs:{id:"redis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[t._v("#")]),t._v(" Redis")]),t._v(" "),s("p",[t._v("因为限流脚本使用到了 "),s("code",[t._v("redis.replicate_commands()")]),t._v(" 命令，这个命令是Redis在3.2版本加入的，所以redis最低版本是3.2")]),t._v(" "),s("p",[t._v("Redis官方并没有提供windows版本，所以，需要使用其他人打包的Windows版本")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/zkteco-home/redis-windows/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("6.2.5及以上"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/tporadowski/redis/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("5.0.14及以下"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开始"}},[t._v("#")]),t._v(" 开始")]),t._v(" "),s("p",[t._v("创建好数据库，并且导入 "),s("code",[t._v("/doc/sql/***/myadmin.sql")]),t._v(" 和 "),s("code",[t._v("/doc/sql/***/quartz_mysql.sql")])]),t._v(" "),s("p",[t._v("修改"),s("code",[t._v("application-dev.yml")]),t._v("中的"),s("code",[t._v("数据库连接信息")]),t._v("、"),s("code",[t._v("redis连接信息")])]),t._v(" "),s("p",[t._v("启动项目，超级管理员账号密码为："),s("code",[t._v("admin/123456")])]),t._v(" "),s("h2",{attrs:{id:"部署教程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署教程"}},[t._v("#")]),t._v(" 部署教程")]),t._v(" "),s("h3",{attrs:{id:"后端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端"}},[t._v("#")]),t._v(" 后端")]),t._v(" "),s("p",[t._v("1.需要使用"),s("code",[t._v("java17、java21及以上版本")]),t._v("或者"),s("code",[t._v("高性能jdk吗，例如azul")])]),t._v(" "),s("p",[t._v("2.需要使用"),s("a",{attrs:{href:"https://jdk.java.net/archive/",target:"_blank",rel:"noopener noreferrer"}},[t._v("openjdk"),s("OutboundLink")],1),t._v("或者"),s("a",{attrs:{href:"https://www.graalvm.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("graalvm"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("3.不能使用"),s("code",[t._v("oraclejdk")])]),t._v(" "),s("p",[t._v("具体原因参考以下"),s("code",[t._v("issues")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/dromara/hutool/issues/2631",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux 环境下 java17 使用 Bouncy Castle 做加解密会出现 JCE cannot authenticate the provider BC 异常 · Issue #2631 · dromara/hutool"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://gitee.com/dromara/hutool/issues/I6G26T",target:"_blank",rel:"noopener noreferrer"}},[t._v("jdk 17 打包后运行报错 SecurityException: JCE cannot authenticate the provider BC · Issue #I6G26T · dromara/hutool - Gitee.com"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://gitee.com/dromara/sa-token/issues/I6BJ8R",target:"_blank",rel:"noopener noreferrer"}},[t._v("springboot3 sa-token-jwt · Issue #I6BJ8R · dromara/Sa-Token - Gitee.com"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"前端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端"}},[t._v("#")]),t._v(" 前端")]),t._v(" "),s("p",[t._v("一般有3种方式部署，我一般使用第1种")]),t._v(" "),s("h4",{attrs:{id:"第1种-通过nginx进行代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第1种-通过nginx进行代理"}},[t._v("#")]),t._v(" 第1种：通过nginx进行代理")]),t._v(" "),s("p",[t._v("通过nginx进行代理")]),t._v(" "),s("p",[t._v("打包命令"),s("code",[t._v("npm run build:prod")]),t._v("\n在"),s("code",[t._v(".env.production")]),t._v("中")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 接口根地址\n# 配置nginx代理\nVUE_APP_BASE_API='/prod-api/my'\n")])])]),s("p",[t._v("nginx配置（仅供参考）")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" myadmin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 代理前端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" /www/wwwroot/myadmin_ui")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html index.htm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" 405=200"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 代理后端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /prod-api/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8033/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_redirect")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Real-IP "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" REMOTE-HOST "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("对于使用宝塔的用户来说，创建一个网站，把打包的"),s("code",[t._v("dist")]),t._v("文件夹放进去，")]),t._v(" "),s("p",[t._v("然后点击网站后面的设置，点击"),s("code",[t._v("配置文件")]),t._v("，\n将以下内容放进去，保存即可")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 代理后端")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /prod-api/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8033/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_redirect")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Real-IP "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" REMOTE-HOST "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解决刷新就404路由问题")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"第2种-不代理-直接访问后端地址方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第2种-不代理-直接访问后端地址方式"}},[t._v("#")]),t._v(" 第2种：不代理，直接访问后端地址方式")]),t._v(" "),s("p",[t._v("直接写后端真实地址，这样会暴露后端地址，容易被攻击")]),t._v(" "),s("p",[t._v("打包命令"),s("code",[t._v("npm run build:prod")]),t._v("\n在"),s("code",[t._v(".env.production")]),t._v("中")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 接口根地址\n# 不配置nginx代理，会暴露后端真实地址\n# VUE_APP_BASE_API='http://192.168.213.130:8033/my'\n")])])]),s("h4",{attrs:{id:"第3种-将前端打包到后端的resources-static下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第3种-将前端打包到后端的resources-static下"}},[t._v("#")]),t._v(" 第3种：将前端打包到后端的resources/static下")]),t._v(" "),s("p",[t._v("这种方式可以实现启动后端，即可访问前端")]),t._v(" "),s("p",[t._v("打包命令"),s("code",[t._v("npm run build:spring")]),t._v("\n在"),s("code",[t._v(".env.spring")]),t._v("中")]),t._v(" "),s("ol",[s("li",[t._v("修改"),s("code",[t._v(".env.spring")]),t._v("中的"),s("code",[t._v("VUE_APP_BASE_API")]),t._v("和"),s("code",[t._v("VUE_APP_CONTEXT_PATH")])]),t._v(" "),s("li",[t._v("修改"),s("code",[t._v("router/index.js")]),t._v("中，mode改为"),s("code",[t._v("hash")])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("export default new Router({\n  base: process.env.VUE_APP_CONTEXT_PATH,\n  // history可以去掉url中的#，nginx部署请选择此项\n  // hash，将前端打包到后端springboot的static文件夹中时请选择此项\n  mode: 'hash',\n  scrollBehavior: () => ({ y: 0 }),\n  routes: constantRoutes\n})\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("打包dist")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建生产环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:spring\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("将dist文件夹里的内容放到后端的"),s("code",[t._v("src/main/resources/static")])]),t._v(" "),s("li",[t._v("设置后端，在"),s("code",[t._v("check-login.ignores")]),t._v("中添加以下内容")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 前端静态资源")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /index.html\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /favicon.ico\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /static/"),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("**")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /error\n")])])]),s("ol",{attrs:{start:"6"}},[s("li",[t._v("启动后端测试，例如后端设置的端口和根路径如下")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 测试环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8033")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context-path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /my\n")])])]),s("p",[t._v("那么后端跑起来之后，前端访问地址为"),s("code",[t._v("http://127.0.0.1:8033/my")])])])}),[],!1,null,null,null);s.default=r.exports}}]);