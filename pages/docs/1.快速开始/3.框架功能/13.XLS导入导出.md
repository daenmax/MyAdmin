---
title: XLS导入导出
date: 2024-01-05 09:58:24
permalink: /pages/76dxfg/
---

## 说明

导入和导出使用了阿里巴巴的`easyexcel`

- 导入和导出均支持单sheet、多sheet
- 支持字典翻译，详情见 字段字典翻译 章节
- 支持脱敏处理，详情见 字段数据脱敏 章节


## 使用案例

### 单sheet
#### 导入
```java
ExcelResult<TestDataImportDto> excelResult = ExcelUtil.importExcel(file.getInputStream(), TestDataImportDto.class, true);
List<TestDataImportDto> dataList = excelResult.getList();
```
#### 导出
```java
List<TestDataPageVo> list = ...;//此处省略数组如何来的
ExcelUtil.exportXlsx(response, "测试数据", "测试数据", list, TestDataPageVo.class);
```

### 多sheet
#### 导入
```java
ExcelReader reader = ExcelUtil.createImport(file.getInputStream());
ReadRetVo<TestSheetADto> sheetA = ExcelUtil.readSheet("班级信息", TestSheetADto.class, true);
ReadRetVo<TestSheetBDto> sheetB = ExcelUtil.readSheet("学生信息", TestSheetBDto.class, true);
        ExcelUtil.finishRead(reader, sheetA, sheetB);

ExcelResult<TestSheetADto> sheetAResult = ExcelUtil.transResult(sheetA);
ExcelResult<TestSheetBDto> sheetBResult = ExcelUtil.transResult(sheetB);

List<TestSheetADto> sheetAList = sheetAResult.getList();
List<TestSheetBDto> sheetBList = sheetBResult.getList();
```
#### 导出
```java
ExcelWriter writer = ExcelUtil.createExport(response, "多sheet表测试");
List<TestSheetADto> sheetAList = ...;//此处省略数组如何来的
ExcelUtil.writeSheet(writer, "班级信息", sheetAList, TestSheetADto.class);
List<TestSheetBDto> sheetBList = ...;//此处省略数组如何来的
ExcelUtil.writeSheet(writer, "学生信息", sheetBList, TestSheetBDto.class);
ExcelUtil.finishWrite(writer);
```
